{% extends '/layout.html.twig' %}

{% block body %}
            {% include 'Event/_common/event_header.html.twig' %}

            <p>What did you like about this event, and what do you think could be
                better for the next time? Leave your feedback to help the organizers
                know what you liked, and what could be improved on.</p>
    
            <h2>Comments</h2>
            {% if event.areCommentsEnabled %}
                {% if flash.getMessages.message %}
                    <div class="alert alert-success">{{flash.getMessages.message}}</div>
                {% endif %}
                <div class="row" id="add-comment">
                    <div class="col-sm-12">
                        <div class="panel panel-default">
                        {% if user %}
                            <div class="panel-heading">
                                <h2 class="panel-title">Write a comment</h2>
                            </div>
                            <div class="panel-body">
                                {% if flash.getMessages.error %}
                                    <div class="alert alert-danger">{{flash.getMessages.error}}</div>
                                {% endif %}
                                <form id="add-comment" role="form" method="POST" action="{{ urlFor('event-add-comment', {'friendly_name': event.getUrlFriendlyName}) }}">
                                    <div class="form-group">
                                        <label for="comment">Your comment:</label>
                                        <textarea id="comment" class="form-control" name="comment"></textarea>
                                    </div>
                                    <div class="form-group">
                                        <button type="submit" class="btn btn-primary">Submit comment</button>
                                    </div>
                                </form>
                            </div>
                        {% else %}
                            <div class="panel-heading">
                                <h2 class="panel-title">Please log in to comment on this event.</h2>
                            </div>
                            <div class="panel-body">
                                {%  include '_common/login.html.twig'  %}
                            </div>
                        {% endif %}
                    {% else %}
                        <p>Comments are closed</p>
                    {% endif %}
                    </div>
                </div>
            </div>

            {% if comments %}
                {% for comment in comments %}
                    {% include '_common/comment.html.twig' with {'comment': comment} %}
                {% endfor %}
            {% endif %}
{% endblock %}

